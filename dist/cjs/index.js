"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("idb"),r=require("crypto-js"),t=require("react"),n=require("@fluentui/react");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function a(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}}),r.default=e,Object.freeze(r)}var s=o(r),i=o(t),c=a(t),l=function(){return l=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},l.apply(this,arguments)};function u(e,r,t,n){return new(t||(t=Promise))(function(o,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function i(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t(function(e){e(r)})).then(s,i)}c((n=n.apply(e,r||[])).next())})}function f(e,r){var t,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=r.call(e,a)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}"function"==typeof SuppressedError&&SuppressedError;var p="FormDraftDB",y="drafts",d=process.env.REACT_APP_SECRET_KEY||"",b=null,v=function(){return b||(b=e.openDB(p,1,{upgrade:function(e){e.createObjectStore(y,{keyPath:"key"})}})),b},m=function(e){return s.default.AES.encrypt(e,d).toString()},h=function(e){return s.default.AES.decrypt(e,d).toString(s.default.enc.Utf8)},g=function(e){return new Promise(function(r,t){var n=new FileReader;n.onload=function(){return r({name:e.name,type:e.type,data:n.result})},n.onerror=t,n.readAsDataURL(e)})},S=function(e){return u(void 0,void 0,void 0,function(){var r,t;return f(this,function(n){switch(n.label){case 0:return[4,fetch(e.data)];case 1:return[4,n.sent().blob()];case 2:return r=n.sent(),t=e.name||e.FileName||"untitled",[2,new File([r],t,{type:e.type})]}})})},k=function(e){var r=e.keysArr;return u(void 0,void 0,void 0,function(){var e,t,n,o,a,s;return f(this,function(i){switch(i.label){case 0:return[4,v()];case 1:e=i.sent(),t=e.transaction(y,"readwrite"),n=t.objectStore(y),o=0,a=r,i.label=2;case 2:return o<a.length?(s=a[o],[4,n.delete(s)]):[3,5];case 3:i.sent(),i.label=4;case 4:return o++,[3,2];case 5:return[4,t.done];case 6:return i.sent(),[2]}})})},j=function(e){return u(void 0,void 0,void 0,function(){var r,t,n;return f(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,v()];case 1:return[4,o.sent().get(y,e)];case 2:return(r=o.sent())?(t=h(r.value),[2,JSON.parse(t)]):[2,null];case 3:return n=o.sent(),console.error("getDraftFromStorage failed:",n),[2,null];case 4:return[2]}})})},w=function(e){return u(void 0,void 0,void 0,function(){var r,t,n;return f(this,function(o){switch(o.label){case 0:r=0,t=e,o.label=1;case 1:return r<t.length?(n=t[r],[4,O(n)]):[3,4];case 2:if(o.sent())return[2,!0];o.label=3;case 3:return r++,[3,1];case 4:return[2,!1]}})})},O=function(e){return u(void 0,void 0,void 0,function(){var r;return f(this,function(t){switch(t.label){case 0:return[4,v()];case 1:return[4,t.sent().get(y,e)];case 2:return[2,!(!(r=t.sent())||!r.value)]}})})},_={exports:{}},x={},P=Symbol.for("react.transitional.element"),A=Symbol.for("react.fragment");function E(e,r,t){var n=null;if(void 0!==t&&(n=""+t),void 0!==r.key&&(n=""+r.key),"key"in r)for(var o in t={},r)"key"!==o&&(t[o]=r[o]);else t=r;return r=t.ref,{$$typeof:P,type:e,key:n,ref:void 0!==r?r:null,props:t}}x.Fragment=A,x.jsx=E,x.jsxs=E;var N={};
/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */"production"!==process.env.NODE_ENV&&function(){function e(r){if(null==r)return null;if("function"==typeof r)return r.$$typeof===_?null:r.displayName||r.name||null;if("string"==typeof r)return r;switch(r){case d:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case S:return"Suspense";case k:return"SuspenseList";case O:return"Activity"}if("object"==typeof r)switch("number"==typeof r.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),r.$$typeof){case y:return"Portal";case h:return r.displayName||"Context";case m:return(r._context.displayName||"Context")+".Consumer";case g:var t=r.render;return(r=r.displayName)||(r=""!==(r=t.displayName||t.name||"")?"ForwardRef("+r+")":"ForwardRef"),r;case j:return null!==(t=r.displayName||null)?t:e(r.type)||"Memo";case w:t=r._payload,r=r._init;try{return e(r(t))}catch(e){}}return null}function r(e){return""+e}function t(e){try{r(e);var t=!1}catch(e){t=!0}if(t){var n=(t=console).error,o="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",o),r(e)}}function n(r){if(r===d)return"<>";if("object"==typeof r&&null!==r&&r.$$typeof===w)return"<...>";try{var t=e(r);return t?"<"+t+">":"<...>"}catch(e){return"<...>"}}function o(){return Error("react-stack-top-frame")}function a(){var r=e(this.type);return D[r]||(D[r]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(r=this.props.ref)?r:null}function s(r,n,o,s,i,l){var f,y=n.children;if(void 0!==y)if(s)if(A(y)){for(s=0;s<y.length;s++)c(y[s]);Object.freeze&&Object.freeze(y)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else c(y);if(P.call(n,"key")){y=e(r);var d=Object.keys(n).filter(function(e){return"key"!==e});s=0<d.length?"{key: someKey, "+d.join(": ..., ")+": ...}":"{key: someKey}",C[y+s]||(d=0<d.length?"{"+d.join(": ..., ")+": ...}":"{}",console.error('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',s,y,d,y),C[y+s]=!0)}if(y=null,void 0!==o&&(t(o),y=""+o),function(e){if(P.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return void 0!==e.key}(n)&&(t(n.key),y=""+n.key),"key"in n)for(var b in o={},n)"key"!==b&&(o[b]=n[b]);else o=n;return y&&function(e,r){function t(){u||(u=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",r))}t.isReactWarning=!0,Object.defineProperty(e,"key",{get:t,configurable:!0})}(o,"function"==typeof r?r.displayName||r.name||"Unknown":r),function(e,r,t,n,o,s){var i=t.ref;return e={$$typeof:p,type:e,key:r,props:t,_owner:n},null!==(void 0!==i?i:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:a}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:o}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:s}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(r,y,o,null===(f=x.A)?null:f.getOwner(),i,l)}function c(e){l(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===w&&("fulfilled"===e._payload.status?l(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function l(e){return"object"==typeof e&&null!==e&&e.$$typeof===p}var u,f=i.default,p=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),_=Symbol.for("react.client.reference"),x=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=Object.prototype.hasOwnProperty,A=Array.isArray,E=console.createTask?console.createTask:function(){return null},D={},T=(f={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(f,o)(),R=E(n(o)),C={};N.Fragment=d,N.jsx=function(e,r,t){var o=1e4>x.recentlyCreatedOwnerStacks++;return s(e,r,t,!1,o?Error("react-stack-top-frame"):T,o?E(n(e)):R)},N.jsxs=function(e,r,t){var o=1e4>x.recentlyCreatedOwnerStacks++;return s(e,r,t,!0,o?Error("react-stack-top-frame"):T,o?E(n(e)):R)}}(),"production"===process.env.NODE_ENV?_.exports=x:_.exports=N;exports.checkHasDraftInStorage=w,exports.checkStorageAndNotify=function(e,r,t){return u(void 0,void 0,void 0,function(){var n,o,a,s,i,c,l;return f(this,function(u){switch(u.label){case 0:return[4,v()];case 1:n=u.sent(),o=n.transaction(y,"readonly").objectStore(y),a=!1,s=0,i=e,u.label=2;case 2:return s<i.length?(c=i[s],[4,o.get(c)]):[3,5];case 3:if((l=u.sent())&&l.value)return a=!0,[3,5];u.label=4;case 4:return s++,[3,2];case 5:return a?setTimeout(function(){r(e,t)},1e3):t(!1),[2]}})})},exports.decryptPassword=h,exports.encryptPassword=m,exports.fileToJson=g,exports.getDraftFromStorage=j,exports.jsonToFile=S,exports.removeDraftFromStorage=k,exports.saveDraftToStorage=function(r){var t=r.entries;return u(void 0,void 0,void 0,function(){var r,n,o,a,s,i,c,l,u,d,b,v,h,S,k;return f(this,function(f){switch(f.label){case 0:return[4,e.openDB(p,1)];case 1:r=f.sent(),n=[],o=0,a=t,f.label=2;case 2:return o<a.length?(s=a[o],i=s[0],c=s[1],l=c,Array.isArray(c)&&c.length&&c[0]instanceof File?[4,Promise.all(c.map(g))]:[3,4]):[3,9];case 3:return u=f.sent(),l=m(JSON.stringify(u)),[3,7];case 4:return c instanceof File?[4,g(c)]:[3,6];case 5:return d=f.sent(),l=m(JSON.stringify(d)),[3,7];case 6:(Array.isArray(c)&&c.length||!Array.isArray(c)&&c)&&(l=m(JSON.stringify(c))),f.label=7;case 7:n.push({key:i,value:l}),f.label=8;case 8:return o++,[3,2];case 9:b=r.transaction(y,"readwrite"),v=b.objectStore(y),h=0,S=n,f.label=10;case 10:return h<S.length?(k=S[h],[4,v.put(k)]):[3,13];case 11:f.sent(),f.label=12;case 12:return h++,[3,10];case 13:return[4,b.done];case 14:return f.sent(),[2]}})})},exports.useDraftCheck=function(e){var r=e.keys,t=e.onConfirm,o=e.condition,a=void 0===o||o,s=e.dependencies,i=void 0===s?[]:s,p=c.useState(!1),y=p[0],d=p[1],b=c.useState({}),v=b[0],m=b[1];c.useEffect(function(){a&&u(void 0,void 0,void 0,function(){var e,n,o,a,s,i,c;return f(this,function(l){switch(l.label){case 0:return l.trys.push([0,8,,9]),[4,w(r)];case 1:e=l.sent(),n={},o=0,a=r,l.label=2;case 2:return o<a.length?(s=a[o],[4,j(s)]):[3,7];case 3:return(i=l.sent())&&Object.hasOwn(i,"data")&&Object.hasOwn(i,"type")&&Object.hasOwn(i,"name")?[4,S(i)]:[3,5];case 4:i=l.sent(),l.label=5;case 5:null!=i&&(n[s]=i),l.label=6;case 6:return o++,[3,2];case 7:return m(n),e?setTimeout(function(){d(!0)},1e3):t(null),[3,9];case 8:return c=l.sent(),console.error("checkHasDraftInStorage failed:",c),t(null),[3,9];case 9:return[2]}})})},function(e,r,t){if(t||2===arguments.length)for(var n,o=0,a=r.length;o<a;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))}([],i,!0));var h=c.useCallback(function(){d(!1),t(v)},[t,v]),g=c.useCallback(function(){d(!1),t(null),k({keysArr:r})},[t,r]);return{dialog:_.exports.jsx(n.Dialog,l({hidden:!y,onDismiss:g,dialogContentProps:{type:n.DialogType.normal,title:"Restore data?",closeButtonAriaLabel:"Close",subText:"Do you want to restore the previously entered data before submitting/saving again?"},minWidth:450,modalProps:{isBlocking:!0}},{children:_.exports.jsxs(n.DialogFooter,{children:[_.exports.jsx(n.PrimaryButton,{onClick:h,text:"Yes, restore"}),_.exports.jsx(n.DefaultButton,{onClick:g,text:"No"})]})}))}};
//# sourceMappingURL=index.js.map
